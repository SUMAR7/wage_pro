<div class="profile-header">
  <h1 class="mb-4 font-bold text-4xl">Profile</h1>
  <h1 class="mb-4 text-3xl font-extrabold text-gray-900 dark:text-white md:text-5xl lg:text-6xl"><span class="text-transparent bg-clip-text bg-gradient-to-r to-emerald-600 from-sky-400"><%= current_user.name%></h1>
  <p class="text-lg font-normal text-gray-500 lg:text-xl dark:text-gray-400">
    <%= @designations.size > 1 ? @designations.join(" | ") : @designations.first %> - <%= @user.email %> - <% @user.roles.each do |role| %>
      <span class="bg-yellow-100 text-yellow-800 text-xs font-medium me-2 px-2.5 py-1 rounded-full dark:bg-yellow-900 dark:text-yellow-300"><%= role.name %></span>
  <% end %>
  </p>
</div>

<div class="profile-personal-details my-4">
  <div class="w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
    <div class="sm:hidden">
      <label for="tabs" class="sr-only">Select tab</label>
      <select id="tabs" class="bg-gray-50 border-0 border-b border-gray-200 text-gray-900 text-sm rounded-t-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
        <option>Personal Details</option>
        <option>Bank Details</option>
        <option>Employment Details</option>
      </select>
    </div>
    <ul class="hidden text-sm font-medium text-center text-gray-500 divide-x divide-gray-200 rounded-lg sm:flex dark:divide-gray-600 dark:text-gray-400 rtl:divide-x-reverse" id="fullWidthTab" data-tabs-toggle="#fullWidthTabContent" role="tablist">
      <li class="w-full">
        <button id="personal-details" data-tabs-target="#p-details" type="button" role="tab" aria-controls="p-details" aria-selected="true" class="inline-block w-full p-4 rounded-ss-lg bg-gray-50 hover:bg-gray-100 focus:outline-none dark:bg-gray-700 dark:hover:bg-gray-600">Personal Details</button>
      </li>
      <li class="w-full">
        <button id="bank-details" data-tabs-target="#p-bank-details" type="button" role="tab" aria-controls="p-bank-details" aria-selected="false" class="inline-block w-full p-4 bg-gray-50 hover:bg-gray-100 focus:outline-none dark:bg-gray-700 dark:hover:bg-gray-600">Bank Details</button>
      </li>
      <li class="w-full">
        <button id="employment-details" data-tabs-target="#faq" type="button" role="tab" aria-controls="faq" aria-selected="false" class="inline-block w-full p-4 rounded-se-lg bg-gray-50 hover:bg-gray-100 focus:outline-none dark:bg-gray-700 dark:hover:bg-gray-600">Employment Details</button>
      </li>
    </ul>
    <div id="fullWidthTabContent" class="border-t border-gray-200 dark:border-gray-600">
      <div class="hidden bg-white rounded-lg dark:bg-gray-800" id="p-details" role="tabpanel" aria-labelledby="personal-details">

        <% if @user_profile.present? %>
          <!-- About Section -->
          <div class="bg-white p-3 shadow-sm rounded-sm">
            <div class="flex items-center space-x-2 mb-2 font-semibold text-gray-900 leading-8">
                        <span clas="text-green-500">
                            <svg class="h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </span>
              <span class="tracking-wide">About</span>
            </div>
            <div class="text-gray-700">
              <div class="grid md:grid-cols-2 text-sm">
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Date of Birth</div>
                  <div class="px-4 py-2"><%= @user_profile.birthday&.strftime("%B %d, %Y") || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Gender</div>
                  <div class="px-4 py-2"><%= @user_profile.gender || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Disability Status</div>
                  <div class="px-4 py-2"><%= @user_profile.is_disable? ? 'Disable' : 'None' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Disability Description</div>
                  <div class="px-4 py-2"><%= @user_profile.disability_description || 'N/A' %></div>
                </div>
              </div>
            </div>

            <div class="flex items-center space-x-2 mt-5 mb-2 font-semibold text-gray-900 leading-8">
                        <span clas="text-green-500">
                            <svg class="h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </span>
              <span class="tracking-wide">Contact Information</span>
            </div>
            <div class="text-gray-700">
              <div class="grid md:grid-cols-2 text-sm">
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Email</div>
                  <div class="px-4 py-2">
                    <a class="text-blue-800" href="mailto:<%= @user.email %>"><%= @user.email %></a>
                  </div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Phone</div>
                  <div class="px-4 py-2"><%= @user_profile.phone || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Address</div>
                  <div class="px-4 py-2"><%= @user_profile.address || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Nationality</div>
                  <div class="px-4 py-2"><%= @user_profile.nationality || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Local Resident?</div>
                  <div class="px-4 py-2"><%= @user_profile.is_local_resident? ? 'YES' : 'NO' %></div>
                </div>
              </div>
            </div>

            <div class="flex items-center space-x-2 mt-5 mb-2 font-semibold text-gray-900 leading-8">
                        <span clas="text-green-500">
                            <svg class="h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </span>
              <span class="tracking-wide">Alternate Contact Information</span>
            </div>
            <div class="text-gray-700">
              <div class="grid md:grid-cols-2 text-sm">
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Email</div>
                  <div class="px-4 py-2">
                    <a class="text-blue-800" href="mailto:<%= @user_profile.alternate_email %>"><%= @user_profile.alternate_email || 'N/A' %></a>
                  </div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Phone</div>
                  <div class="px-4 py-2"><%= @user_profile.alternate_phone || 'N/A' %></div>
                </div>
              </div>
            </div>

            <div class="flex items-center space-x-2 mt-5 mb-2 font-semibold text-gray-900 leading-8">
                        <span clas="text-green-500">
                            <svg class="h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </span>
              <span class="tracking-wide">Emergency Contact Information</span>
            </div>
            <div class="text-gray-700">
              <div class="grid md:grid-cols-2 text-sm">
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Name</div>
                  <div class="px-4 py-2"><%= @user_profile.emergency_contact_name || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Phone</div>
                  <div class="px-4 py-2"><%= @user_profile.emergency_contact_phone || 'N/A' %></div>
                </div>
              </div>
            </div>
          </div>
          <a href="<%= edit_profile_profile_path %>"
            class="block text-center w-full text-blue-800 text-sm font-semibold rounded-lg hover:bg-gray-100 focus:outline-none focus:shadow-outline focus:bg-gray-100 hover:shadow-xs p-3 my-4">
            <%= @user.has_role?(:admin) ? 'Edit Profile' : 'Request Changes' %></a>
        <% else %>
          <%= render 'shared/empty_resource', title: 'Create a profile', description: 'No profile exist for this user yet!', cta_url: new_profile_profile_path(@user) %>
        <% end %>
        <!-- End of about section -->
      </div>

      <!-- Bank details -->
      <% if @user_profile.present? %>
        <div class="hidden bg-white rounded-lg md:p-4 dark:bg-gray-800" id="p-bank-details" role="tabpanel" aria-labelledby="bank-details">
          <div class="bg-white shadow-sm rounded-sm">
            <div class="flex items-center space-x-2 mb-2 font-semibold text-gray-900 leading-8">
                        <span clas="text-green-500">
                            <svg class="h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </span>
              <span class="tracking-wide">Bank Details</span>
            </div>
            <div class="text-gray-700">
              <div class="grid md:grid-cols-2 text-sm">
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Bank Name</div>
                  <div class="px-4 py-2"><%= @user_profile.bank_name || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Account Name</div>
                  <div class="px-4 py-2"><%= @user_profile.bank_account_name || 'N/A' %></div>
                </div>
                <div class="grid grid-cols-2">
                  <div class="px-4 py-2 font-semibold">Account Number</div>
                  <div class="px-4 py-2"><%= @user_profile.bank_account_number || 'N/A' %></div>
                </div>
              </div>
            </div>
          </div>
          <a href="<%= edit_profile_profile_path %>"
             class="block text-center w-full text-blue-800 text-sm font-semibold rounded-lg hover:bg-gray-100 focus:outline-none focus:shadow-outline focus:bg-gray-100 hover:shadow-xs p-3 my-4">
            <%= @user.has_role?(:admin) ? 'Edit Profile' : 'Request Changes' %></a>
        </div>
      <% else %>
        <%= render 'shared/empty_resource', title: 'Add Bank Details', description: 'No bank details exist for this user yet!', cta_url: new_profile_profile_path(@user) %>
      <% end %>

      <!-- End of bank details -->
      <div class="hidden p-4 bg-white rounded-lg dark:bg-gray-800" id="faq" role="tabpanel" aria-labelledby="employment-details">
        <div id="accordion-flush" data-accordion="collapse" data-active-classes="bg-white dark:bg-gray-800 text-gray-900 dark:text-white" data-inactive-classes="text-gray-500 dark:text-gray-400">

          <% @organizations.each do |organization| %>
            <h2 id="accordion-flush-heading-<%= organization.id %>">
              <button type="button" class="flex items-center justify-between w-full py-5 font-medium text-left rtl:text-right text-gray-500 border-b border-gray-200 dark:border-gray-700 dark:text-gray-400" data-accordion-target="#accordion-flush-body-<%= organization.id %>" aria-expanded="true" aria-controls="accordion-flush-body-<%= organization.id %>">
                <span><%= organization.name %></span>
                <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                </svg>
              </button>
            </h2>
            <div id="accordion-flush-body-<%= organization.id %>" class="hidden" aria-labelledby="accordion-flush-heading-<%= organization.id %>">
              <div class="salary-slips m-10">
                <!--    Button to go to salary slips index page-->
                <a href="<%= organization_employee_salary_slips_path(organization, @user)  %>" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4">View Salary Slips</a>
              </div>
              <% organization.department_employees.includes(:department).where(user_id: @user.id).each do |department_employee| %>
                <div class="bg-white">
                  <div class="mx-auto max-w-7xl px-6 lg:px-8">
                    <div class="mx-auto mt-2 max-w-2xl rounded-3xl ring-1 ring-gray-200 sm:mt-4 lg:mx-0 lg:flex lg:max-w-none">
                      <div class="p-8 sm:p-10 lg:flex-auto">
                        <a href="<%= organization_department_department_employee_path(organization, department_employee.department, department_employee) %>">
                          <h3 class="text-2xl font-bold tracking-tight text-blue-500"><%= department_employee.department.name %></h3>
                        </a>
                        <p class="mt-6 text-base leading-7 text-gray-600"><%= department_employee.department.description %></p>
                        <div class="mt-10 flex items-center gap-x-4">
                          <h4 class="flex-none text-sm font-semibold leading-6 text-indigo-600">Designation</h4>
                          <div class="h-px flex-auto bg-gray-100"></div>
                        </div>
                        <ul role="list" class="mt-8 grid grid-cols-1 gap-4 text-sm leading-6 text-gray-600 sm:grid-cols-2 sm:gap-6">
                          <li class="flex gap-x-3">
                            <svg class="h-6 w-5 flex-none text-indigo-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                              <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                            </svg>
                            <%= department_employee.designation || 'N/A' %>
                          </li>
                          <li class="flex gap-x-3">
                            <svg class="h-6 w-5 flex-none text-indigo-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                              <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                            </svg>
                            <%= department_employee.description || 'N/A' %>
                          </li>
                          <li class="flex gap-x-3">
                            <svg class="h-6 w-5 flex-none text-indigo-600" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                              <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                            </svg>
                            <%= department_employee.roles.pluck(:name).join(", ").presence || 'No roles' %>
                          </li>
                        </ul>
                        <div class="mt-10 flex items-center gap-x-4">
                          <h4 class="flex-none text-sm font-semibold leading-6 text-indigo-600">Salary Information</h4>
                          <div class="h-px flex-auto bg-gray-100"></div>
                        </div>
                        <div class="text-gray-700">
                          <div class="grid md:grid-cols-2 text-sm">
                            <div class="grid grid-cols-2">
                              <div class="px-4 py-2 font-semibold">Base Salary</div>
                              <div class="px-4 py-2"><%= department_employee.base_salary / 100 || 'N/A' %></div>
                            </div>
                            <div class="grid grid-cols-2">
                              <div class="px-4 py-2 font-semibold">Payment Currency</div>
                              <div class="px-4 py-2"><%= organization.currency || 'N/A' %></div>
                            </div>
                            <div class="grid grid-cols-2">
                              <div class="px-4 py-2 font-semibold">Tax Deduction</div>
                              <div class="px-4 py-2"><%= department_employee.tax / 100 || 'N/A' %></div>
                            </div>
                            <div class="grid grid-cols-2">
                              <div class="px-4 py-2 font-semibold">Deductions</div>
                              <div class="px-4 py-2"><%= department_employee.other_deductions / 100 || 'N/A' %></div>
                            </div>
                            <div class="grid grid-cols-2">
                              <div class="px-4 py-2 font-semibold">Bonus</div>
                              <div class="px-4 py-2"><%= department_employee.bonus / 100 || 'N/A' %></div>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

</div>
